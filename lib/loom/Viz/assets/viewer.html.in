<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>@TITLE@</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Helvetica, Arial, sans-serif; background: #f5f5f5; }
    #toolbar {
      display: flex; align-items: center; gap: 8px;
      padding: 8px 16px; background: #333; color: #fff;
    }
    #toolbar button {
      padding: 4px 12px; border: 1px solid #666; border-radius: 4px;
      background: #555; color: #fff; cursor: pointer; font-size: 14px;
    }
    #toolbar button:hover { background: #777; }
    #toolbar h1 { font-size: 16px; margin-right: auto; }
    #graph-area {
      display: flex; flex: 1; overflow: hidden;
      height: calc(100vh - 48px - 200px);
    }
    #graph-left, #graph-right {
      flex: 1; overflow: auto; position: relative; background: #fff;
      border: 1px solid #ddd;
    }
    #graph-right { display: none; border-left: 2px solid #999; }
    #graph-left svg, #graph-right svg { width: 100%; height: auto; }
    #detail-panel {
      display: none; position: fixed; bottom: 0; left: 0; right: 0;
      max-height: 200px; overflow-y: auto;
      background: #fff; border-top: 2px solid #333; padding: 12px 16px;
      font-size: 13px; font-family: monospace;
    }
    #detail-panel.visible { display: block; }
    #detail-close {
      position: absolute; top: 4px; right: 8px;
      background: none; border: none; font-size: 18px; cursor: pointer;
    }
    .highlight polygon, .highlight ellipse, .highlight path,
    .highlight rect { stroke: #ff6600 !important; stroke-width: 3px !important; }
    .cross-highlight polygon, .cross-highlight ellipse,
    .cross-highlight path, .cross-highlight rect {
      stroke: #0066ff !important; stroke-width: 3px !important;
      stroke-dasharray: 5,3 !important;
    }
    .route-trace path {
      stroke: #ff3300 !important; stroke-width: 4px !important;
    }
    .side-by-side #graph-right { display: block; }
  </style>
</head>
<body>
  <div id="toolbar">
    <h1>@TITLE@</h1>
    <button id="btn-zoom-in">+</button>
    <button id="btn-zoom-out">-</button>
    <button id="btn-fit">Fit</button>
    <button id="btn-mode-toggle" style="display:none">Side-by-Side</button>
  </div>
  <div id="graph-area">
    <div id="graph-left"></div>
    <div id="graph-right"></div>
  </div>
  <div id="detail-panel">
    <button id="detail-close">&times;</button>
    <div id="detail-content"></div>
  </div>

  <script>
    const vizLevel = "@VIZ_LEVEL@";
    const dotSources = @DOT_SOURCES@;
    const mappingData = @MAPPING_DATA@;
    const nodeMetadata = @NODE_METADATA@;
  </script>
  <!-- viz.js WASM engine: inlined at build time or loaded from CDN -->
  @VIZ_JS_BLOCK@
  <script>
    // Renderer and interaction logic injected by HTMLViewer.cpp
    @RENDERER_JS@
  </script>
</body>
</html>
